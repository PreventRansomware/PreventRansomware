"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[378],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(r),m=o,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||a;return r?n.createElement(h,i(i({ref:t},c),{},{components:r})):n.createElement(h,i({ref:t},c))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},9432:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var n=r(7462),o=(r(7294),r(3905));const a={sidebar_position:6},i=void 0,s={unversionedId:"Initial Compromise/Permissive Firewall Rules",id:"Initial Compromise/Permissive Firewall Rules",title:"Permissive Firewall Rules",description:"Firewalls filter traffic that travels in and out of a network. In an ideal world your firewall should allow nothing in and only the bare minimum out. Unfortunately, this isn\u2019t how the real world works. System administrators need to open ports for various business reasons; attackers know this and scour the internet for open ports with which they can breach a network.",source:"@site/docs/Initial Compromise/Permissive Firewall Rules.md",sourceDirName:"Initial Compromise",slug:"/Initial Compromise/Permissive Firewall Rules",permalink:"/docs/Initial Compromise/Permissive Firewall Rules",draft:!1,editUrl:"https://github.com/PreventRansomware/PreventRansomware/docs/Initial Compromise/Permissive Firewall Rules.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Phishing Attacks",permalink:"/docs/Initial Compromise/Phishing Attacks"},next:{title:"Foreword",permalink:"/docs/Post Compromise/Foreword"}},l={},p=[],c={toc:p};function u(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Firewalls filter traffic that travels in and out of a network. In an ideal world your firewall should allow nothing in and only the bare minimum out. Unfortunately, this isn\u2019t how the real world works. System administrators need to open ports for various business reasons; attackers know this and scour the internet for open ports with which they can breach a network."),(0,o.kt)("p",null," Remote Desktop (RDP for short) runs on port 3389; it\u2019s used for remote system administration and user access which increased during the COVID-19 outbreak. Thanks to this increase and plain bad firewall administration, many networks have exposed RDP directly to the open internet. At the time of writing, ",(0,o.kt)("a",{parentName:"p",href:"https://help.shodan.io/the-basics/what-is-shodan"},"Shodan\xa0"),"shows ",(0,o.kt)("a",{parentName:"p",href:"https://www.shodan.io/search?query=Remote+Desktop+Protocol"},"over \ufffcthree million systems with Remote Desktop exposed to the internet.")),(0,o.kt)("p",null,"This is bad because it means an attacker could exploit a ",(0,o.kt)("a",{parentName:"p",href:"https://nvd.nist.gov/vuln/detail/CVE-2019-0708"},"vulnerability in Microsofts RDP protocol")," or guess a working username and password combination to have instant, persistent access to a victim network. The latter has become popular with ",(0,o.kt)("a",{parentName:"p",href:"https://www.varonis.com/blog/darkside-ransomware/"},"ransomware operators.")),(0,o.kt)("p",null,"Having RDP open to the internet is akin to leaving the front door wide open. You should ensure that ",(0,o.kt)("strong",{parentName:"p"},"administrative ports like 3389 are not allowed inbound."),(0,o.kt)("br",{parentName:"p"}),"\n","Other common sensitive management ports which are often left open are:  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"22 - SSH"),(0,o.kt)("li",{parentName:"ul"},"23 (Telnet)"),(0,o.kt)("li",{parentName:"ul"},"443 - Management consoles that shouldn\u2019t be accessible from the outside"),(0,o.kt)("li",{parentName:"ul"},"445 - SMB"),(0,o.kt)("li",{parentName:"ul"},"137 - RPC")),(0,o.kt)("p",null,"As earlier mentioned and regardless of the above list, you should aim to ",(0,o.kt)("strong",{parentName:"p"},"block")," all ports inbound, only allowing what is absolutely necessary to enable your business to function ",(0,o.kt)("strong",{parentName:"p"},"however,")," forcing ports closed on a business that legitimately has a need for them isn\u2019t good practice either. Security risk must be balanced with usability. If your business does require an inbound port to be open you should aim to restrict traffic to a particular source IP address (such as a service provider who needs access) and, if possible, only allowed at particular expected times, such as during working hours. "),(0,o.kt)("p",null,"Auditing firewall rules can be a difficult task because administrators have to juggle many rules which can be handled by different teams or even staff that have moved on. There are tools on the market that can help but our favourite is Shodan, it scans the entire internet and documents its findings in a searchable database. You can input your public IPs into its search bar which will show open ports, vulnerabilities and more.",(0,o.kt)("br",{parentName:"p"}),"\n","If RDP or SSH are shown as below you should aim to close them as soon as possible.\n",(0,o.kt)("img",{parentName:"p",src:"/img/DocImages/openportexample.png",alt:null})),(0,o.kt)("p",null,"Often significant security progress can be made only to be undone by someone else with entirely good intentions who is troubleshooting, implementing or trying to fix a problem. It\u2019s possible that after reading this guide, a system administrator will go and close or restrict inbound RDP only to find (once it\u2019s too late) that somebody else reopened the port at a later date, thus re-exposing the network to attack. ",(0,o.kt)("a",{parentName:"p",href:"https://monitor.shodan.io"},"Shodan Monitor")," allows administrators to receive alerts when ports are open, which shouldn\u2019t be or if new ports are opened. Adding an IP address to a Shodan account and configuring notifications is a simple and cost-effective way of monitoring for unexpected edge of network configuration changes. Signing up for the basic freelancer package provides sufficient capabilities for most organisations."))}u.isMDXComponent=!0}}]);